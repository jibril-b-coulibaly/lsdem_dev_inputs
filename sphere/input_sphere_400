units si
dimension 3
boundary p p p
atom_style ls/dem
# below cutoff was 12.0
comm_modify vel yes cutoff 1.0
atom_modify map yes
newton off

region             box block -50 50 -50 50 -50 50 units box
create_box         1 box

mass 1 1.0

read_data data_sphere_400 add 0 0 shift 2.25 0.0 0.0
read_data data_sphere_400 add 400 1 shift 0.0 0.0 0.0

group           grain1 molecule 1
group           grain2 molecule 2

# Gravity on top grain
fix grav grain1 gravity 9.81 vector -1 0 0

# Immobilise bottom grain
fix immob grain2 freeze

# Initial velocities are given in infile_sphere

neigh_modify   exclude molecule/intra all

fix             1 all rigid/ls/dem molecule infile infile_sphere


pair_style ls/dem 1.0
# pair_coeff * * kn kt mu etan etat knp cut kn1 etan1 kt1 etat1
pair_coeff * * 1.0e7 0 0 0 0 0 1.0 0 0 0 0

thermo_style custom step
timestep 1e-4

thermo 1000
run 1000

thermo 1000
dump mydump grain1 custom 10 atomDump_sphere_400 id type mol x y z vx vy vz fx fy fz

run 100000

