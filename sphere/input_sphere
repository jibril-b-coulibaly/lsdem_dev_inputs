units si
dimension 3
boundary p p p
atom_style sphere
comm_modify vel yes cutoff 12.0
atom_modify map yes
newton off

region             box block -50 50 -50 50 -50 50 units box
create_box         1 box

fix             0 all property/atom mol ghost yes

read_data data_sphere add 0 1 shift 15 0.0 0.0
read_data data_sphere add 1000 2 shift 0.0 0.0 0.0

group           grain1 molecule 1
group           grain2 molecule 2

# Immobilise bottom grain
# fix immob grain2 freeze # This doesn't seem to work
fix noF grain2 setforce 0.0 0.0 0.0

# rotate grain1 by 25 degrees
#displace_atoms grain1 rotate -3 0 0 0 0 1 45.0
#displace_atoms grain2 rotate +3 0 0 0 0 1 45.0
#displace_atoms grain2 rotate -3 0 0 0 0 1 45.0
#displace_atoms grain2 move 0.0 -2.0 0.0
# shift grain1 by 1 unit
# displace_atoms grain1 move 0.0 -1.0 0.0

# Initial velocity given in infile_sphere

neigh_modify   exclude molecule/intra all

fix             1 all rigid/ls/dem molecule infile infile_sphere
fix grav grain1 gravity 9.81 vector -1 0 0

pair_style ls/dem 1.0
# pair_coeff * * kt kn mu cut gamma
pair_coeff * * 10000 2000 0.5 1.0 0.1

thermo_style custom step
timestep 0.0001

thermo 1000
run 500

thermo 500
dump mydump all custom 500 atomDump_sphere id type mol x y z vx vy vz fx fy fz

run 1000000

